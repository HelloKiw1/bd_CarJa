{% extends 'base.html' %}
{% load static %}

{% block titulo %}Meus Veículos - Compras e Locações{% endblock %}

{% block conteudo %}
<div class="container mt-4">
  <h2>Minhas Compras</h2>
  {% if compras %}
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Foto</th>
          <th>Veículo</th>
          <th>Preço</th>
          <th>Data</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        {% for c in compras %}
        <tr>
          <td>
            {% if c.veiculo and c.veiculo.foto %}
              <img src="{{ c.veiculo.foto.url }}" alt="{{ c.veiculo.modelo }}" style="width:48px;height:32px;object-fit:cover;border-radius:4px;" />
            {% else %}
              <img src="{% static 'img/sem-imagem.png' %}" alt="Sem imagem" style="width:48px;height:32px;object-fit:cover;border-radius:4px;" />
            {% endif %}
          </td>
          <td>{% if c.veiculo %}{{ c.veiculo.modelo }}{% else %}—{% endif %}</td>
          <td>R$ {{ c.preco }}</td>
          <td>{{ c.created_at }}</td>
            <td>
            <a href="{% url 'detalhar-veiculo' c.veiculo.id %}" class="btn btn-sm btn-light">
              <i class="fas fa-search"></i> Ver
            </a>
            <a href="{% url 'user-delete-compra' c.id %}" class="btn btn-sm btn-light">
              <i class="fas fa-trash"></i> Remover
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>Você não realizou compras ainda.</p>
  {% endif %}

  <h2 class="mt-5">Minhas Locações</h2>
  {% if locacoes %}
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Foto</th>
          <th>Veículo</th>
          <th>Dias</th>
          <th>Preço da Daira</th>
          <th>Total</th>
          <th>Data</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        {% for l in locacoes %}
        <tr>
          <td>
            {% if l.veiculo and l.veiculo.foto %}
              <img src="{{ l.veiculo.foto.url }}" alt="{{ l.veiculo.modelo }}" style="width:48px;height:32px;object-fit:cover;border-radius:4px;" />
            {% else %}
              <img src="{% static 'img/sem-imagem.png' %}" alt="Sem imagem" style="width:48px;height:32px;object-fit:cover;border-radius:4px;" />
            {% endif %}
          </td>
          <td>{% if l.veiculo %}{{ l.veiculo.modelo }}{% else %}—{% endif %}</td>
          <td>{{ l.dias }}</td>
          <td>R$ {{ l.preco_unitario }}</td>
          <td>R$ {{ l.total }}</td>
          <td>{{ l.created_at }}</td>
          <td>
            <a href="{% url 'detalhar-veiculo' l.veiculo.id %}" class="btn btn-sm btn-light">
              <i class="fas fa-search"></i> Ver
            </a>
            <a href="{% url 'user-delete-locacao' l.id %}" class="btn btn-sm btn-light">
              <i class="fas fa-trash"></i> Remover
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>Você não realizou locações ainda.</p>
  {% endif %}
</div>
{% endblock %}
